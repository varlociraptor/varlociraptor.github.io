<!DOCTYPE html>
<html lang="en">
    <head>
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta http-equiv="content-type" content="text/html; charset=utf-8">

      <!-- Enable responsiveness on mobile devices-->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

      <title>Varlociraptor Homepage</title>

      
      

      <!-- CSS -->
      
      <link rel="stylesheet" href="https://varlociraptor.github.io/book.css">
      

      
      
    </head>

    <body>
        <div class="menu">
            
            
            <nav role="navigation">
                <ul>
                    
                        
                        
                            
                            <li >
                                
                                <a href="https:&#x2F;&#x2F;varlociraptor.github.io&#x2F;landing&#x2F;">
                                    
                                    Home
                                </a>
                                
                            </li>
                        
                            
                            <li >
                                
                                <a href="https:&#x2F;&#x2F;varlociraptor.github.io&#x2F;docs&#x2F;">
                                    
                                    Documentation
                                </a>
                                
                                    <ul>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;varlociraptor.github.io&#x2F;docs&#x2F;installation&#x2F;">
                                                    
                                                    Installation
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;varlociraptor.github.io&#x2F;docs&#x2F;calling&#x2F;">
                                                    
                                                    Calling variants
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;varlociraptor.github.io&#x2F;docs&#x2F;filtering&#x2F;">
                                                    
                                                    Filtering variant calls
                                                </a>
                                            </li>
                                        
                                            <li class="active">
                                                <a href="https:&#x2F;&#x2F;varlociraptor.github.io&#x2F;docs&#x2F;estimating&#x2F;">
                                                    
                                                    Estimating properties
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;varlociraptor.github.io&#x2F;docs&#x2F;output&#x2F;">
                                                    
                                                    Output format
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;varlociraptor.github.io&#x2F;docs&#x2F;reporting-issues&#x2F;">
                                                    
                                                    Reporting issues
                                                </a>
                                            </li>
                                        
                                            <li >
                                                <a href="https:&#x2F;&#x2F;varlociraptor.github.io&#x2F;docs&#x2F;model&#x2F;">
                                                    
                                                    Statistical model
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                        
                            
                            <li >
                                
                                <a href="https:&#x2F;&#x2F;varlociraptor.github.io&#x2F;authors&#x2F;">
                                    
                                    Authors
                                </a>
                                
                            </li>
                        
                    
                    <li><a href="https://varlociraptor.github.io/varlociraptor-scenarios">Scenario catalog</a></li>
                </ul>
            </nav>
            
            <img src="/landing/varlociraptor-logo.svg" style="width: 8em; margin: auto; display: block; margin-top: 2em" />
            
        </div>

        <div class="page">
            <div class="page__header">
                <div class="menu-icon">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
                
                <span class="search-icon">ðŸ”Ž</span>
                
            </div>

            <div class="page__content">
                
                <div class="search-container">
                    <input id="search" type="search" placeholder="Search..">
                    <div class="search-results">
                        <div class="search-results__header"></div>
                        <ul class="search-results__items"></ul>
                    </div>
                </div>
                
                <div class="book-content">
                    
    <h1>Estimating properties</h1>
    <h2 id="estimating-alignment-properties">Estimating alignment properties</h2>
<p>In order to judge about candidate indel and structural variants, Varlociraptor needs to know about certain properties of the underlying sequencing experiment in combination with the used read aligner.
This includes the maximum feasible softclip size of the aligner, the insert size of the sequencing library, the expected amounts of homopolymer errors and the probabilities of opening and extending gaps.
While Varlociraptor is able to estimate these on the fly, it is recommended to perform this estimation per sample before processing variant calls, in order to save time upon repeated runs or during parallelization.
Given that the sample is given as a sorted (by position) BAM file <code>sample.bam</code>, estimation can be performed as</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">varlociraptor</span><span> estimate alignment-properties reference.fa</span><span style="color:#bf616a;"> --bam</span><span> sample.bam &gt; sample.alignment-properties.json
</span></code></pre>
<p>By default, varlociraptor uses all suitable alignments in the provided file, use <code>--num-records NUM</code> to restrict the number of alignments used.</p>
<p>The alignment properties can then be passed on to <code>varlociraptor preprocess variants</code>, see <a href="https://varlociraptor.github.io/docs/calling/">Calling variants</a>.</p>
<h2 id="estimating-mutational-burden">Estimating mutational burden</h2>
<p>Varlociraptor enables an uncertainty aware computation of the mutational burden (or tumor mutational burden (TMB) in a tumor context).
Mutational burden is usually defined as the number of non-synonymous coding mutations per megabase of the measured coding genome (in tumor context restricted to e.g. somatic mutations).
With</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">varlociraptor</span><span> estimate mutational-burden</span><span style="color:#bf616a;"> --coding-genome-size</span><span> 3e7</span><span style="color:#bf616a;"> --sample</span><span> tumor ---events SOMATIC_TUMOR &lt; calls.annotated.bcf &gt; tmb.vl.json
</span></code></pre>
<p>Varlociraptor will produce a <a href="https://vega.github.io/vega-lite">Vega-Lite</a> specification of a plot, where the x-axis depicts the
minimum allele frequency, and the y-axis shows the mutational burden in mutations per megabase.
The input file <code>calls.annotated.bcf</code> has to be a VCF/BCF file that has been obtained from Varlociraptor and annotated with e.g. <a href="http://snpeff.sourceforge.net">SnpEff</a>, such that Varlociraptor can select non-synonymous coding mutations.
The vega specification is a text file in JSON format, that can be converted to e.g. an SVG image via the <a href="https://anaconda.org/conda-forge/vega-lite-cli">Vega-Lite command line utilities</a>:</p>
<pre data-lang="bash" style="background-color:#2b303b;color:#c0c5ce;" class="language-bash "><code class="language-bash" data-lang="bash"><span style="color:#bf616a;">vl2svg</span><span> tmb.vl.json tmb.svg
</span></code></pre>
<p>Note that the coding genome size given with <code>--coding-genome-size</code> has to reflect the <em>measured part</em> of the coding genome.
In case the estimation is conducted on e.g. panel sequencing (where only a small number of genes is captured), the value has
to be the size of the coding genome within this capturing.
After using vl2svg for convertion of the JSON to an image, the result can look like this:</p>
<p><img src="../tmb.svg" alt="example-tmb-plot" /></p>
<p>Importantly, the mutational burden is calculated as expected value over the posterior probabilities for each variant to be of the event of interest (e.g. somatic).
Hence, the mutational burden estimate properly considers the uncertainty in the data.
Moreover, as we show a mutational burden estimate for each minimum allele frequency, it becomes possible to reason e.g. over the clonal structure
of a tumor, instead of considering only a single overall number. We expect this to increase the predictive power of
mutational burden analyses.</p>


                </div>
            </div>

            <div class="prev-link">
                
    
        
        
        <a class="previous" href="https:&#x2F;&#x2F;varlociraptor.github.io&#x2F;docs&#x2F;"><</a>
    

            </div>

            <div class="next-link">
                
    
        
        
        
        
            
            
            
        
            
            
            
                
            
                
            
                
            
                
                    
                
            
                
            
                
            
                
            
        
            
            
                <a class="next" href="https:&#x2F;&#x2F;varlociraptor.github.io&#x2F;authors&#x2F;">></a>
                
                
            
            
        
    

            </div>
        </div>

        
            
            <script type="text/javascript" src="https://varlociraptor.github.io/elasticlunr.min.js"></script>
            <script type="text/javascript" src="https://varlociraptor.github.io/search_index.en.js"></script>
            
            <script type="text/javascript" src="https://varlociraptor.github.io/book.js"></script>
        
    </body>

</html>
